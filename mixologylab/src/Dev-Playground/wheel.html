<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html{
            overflow:hidden;
        }
        body{
            background: black;
        }

        .wheel{
            position: relative;
            margin: 1em auto;
            width: 16em; height: 16em;
            border-radius: 50%;
            background:
                    linear-gradient(60deg, #272b66 63.5%, transparent 42.34%) 0 0,
                    /*linear-gradient(72deg, #2d559f 75.48%, transparent 75.48%) 0 0,*/
                    linear-gradient(-60deg, #9ac147 63.5%, transparent 42.34%) 100% 0,
                    /*linear-gradient(-72deg, #639b47 75.48%, transparent 75.48%) 100% 0,*/
                    linear-gradient(60deg, transparent 36.5%, #e1e23b 36.5%) 100% 100%,
                    /*linear-gradient(72deg, transparent 24.52%, #f7941e 24.52%) 100% 100%,*/
                    linear-gradient(-60deg, transparent 36.5%, #662a6c 36.5%) 0% 100%,
                    /*linear-gradient(-72deg, transparent 24.52%, #9a1d34 24.52%) 0 100%,*/
                    #43a1cd linear-gradient(#ba3e2e, #ba3e2e) 50% 100%;
            background-repeat: no-repeat;
            background-size: 50% 50%;
            transition: 0.05s linear;
        }
        .text{
            color:black;
            height: 20px;
        }
        .text1{
            color:white
        }

        #drinkname{
            font-size: 2em
        }






    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.js"></script>
</head>
<body>

<div id="wheel" class="wheel" onmousemove="mouseToSpinWheel(event)" onmousedown="down=1" onmouseup="down=0">

</div>


<input class="text" id="angle" type="number" placeholder="0" value="0" onchange="inputUpdate(this.value)"/>
<div class="text1" id="test">fdfdfdfds</div>
<div class="text1" >x-coordinates: <span id="xco"></span></div>
<div class="text1" >y-coordinates: <span id="yco"></span></div>
<div class="text1" >Degrees: <span id="test1"></span></div>
<div class="text1" >Starting Degree: <span id="test3"></span></div>
<div class="text1" >Infinite Degree: <span id="test2"></span></div>
<div class="text1">Drink Name: <span id="drinkname"></span></div>
<script>

let x, y, startingDegree, absoluteDegree =0, absOffsetDegree, down
let previousAbsOffsetDegree
let numberRotationsCounter = 0
let infiniteDegrees =0



const  alcoholList = {
    alcohol1: {
        name: "Vodka",
        abbr: "Vod",
        color: "yellow",
        startDegree: 0,
        stopDegree: 59.999
    },
    alcohol2: {
        name: "Brandy",
        abbr: "Bran",
        color: "red",
        startDegree: 60,
        stopDegree: 119.999
    },
    alcohol3: {
        name: "Gin",
        abbr: "Gin",
        color: "green",
        startDegree: 120,
        stopDegree: 179.999
    },
    alcohol4: {
        name: "Whisky",
        abbr: "Whis",
        color: "brown",
        startDegree: 180,
        stopDegree: 239.999
    },
    alcohol5: {
        name: "Tequila",
        abbr: "Teq",
        color: "orange",
        startDegree: 240,
        stopDegree: 299.999
    },
    alcohol6: {
        name: "Rum",
        abbr: "Rum",
        color: "blue",
        startDegree: 300,
        stopDegree: 359.999
    }
}


function inputUpdate(angle){
document.getElementById("test").innerText = angle
document.getElementById('wheel').style.transform = `rotate(${angle}deg)`
    }

function mouseToSpinWheel(e){
    const wheel = document.getElementById("wheel")
    // Goal: grab x and y coordinates
    // Notes: Position (0, 0) is at the center of the wheel
    // Math: x-coordinate = cursor position - div offset - half div size
    x = e.clientX - wheel.offsetLeft - (wheel.clientHeight)/2;
    y = e.clientY - wheel.offsetTop - (wheel.clientWidth)/2;
    // Goal: Grab Starting Degree so we offset it
    if (down != 1){
        startingDegree = Math.atan2(y,x)*(180/Math.PI)
        startingDegree = (-infiniteDegrees+startingDegree+360)%360
    }

    // Goal: Convert coordinates to 360 degree spin.
    // Goal: Grab coordinates only while mouse is down
    // Notes: Uses arc tangent to grab math. Since degrees goes from
    // -180 degrees to +180 degrees, we use mod function.
    if (down === 1) {
        absoluteDegree = Math.atan2(y, x) * (180 / Math.PI)
        absoluteDegree = (absoluteDegree + 360) % 360
        //Goal: When going from 345 degrees to 15 degrees, add one to the
        //rotation counter.  When going from 15 to 345, subtract one.

        absOffsetDegree = (absoluteDegree - startingDegree + 360) % 360


        if (previousAbsOffsetDegree > 345 && absOffsetDegree < 15) {
            numberRotationsCounter++
        }
        if (previousAbsOffsetDegree < 15 && absOffsetDegree > 345) {
            numberRotationsCounter--
        }
        //Goal: Record previous degree state so we know whether to
        //increment numberRotationCounter.
        previousAbsOffsetDegree = absOffsetDegree

        infiniteDegrees = numberRotationsCounter * 360 + absOffsetDegree

        inputUpdate(infiniteDegrees)
        document.getElementById("drinkname").innerText = wheelSelectorByDegree(infiniteDegrees)[0]["name"]
        document.getElementById("drinkname").style.color = wheelSelectorByDegree(infiniteDegrees)[0]["color"]

    }










    //Debugging Tools
    document.getElementById("yco").innerText = y
    document.getElementById("xco").innerText = x
    document.getElementById("test1").innerText = absOffsetDegree
    document.getElementById("test2").innerText = infiniteDegrees
    document.getElementById("test3").innerText = startingDegree


}

function wheelSelectorByDegree(degrees) {
    let selectDegrees
    if (degrees<=0){
        //for negative numbers
        selectDegrees = 360+(degrees%360)
    } else {
        selectDegrees = degrees % 360
    }
    const arr = Object.keys(alcoholList).map(function (key) {
        if (alcoholList[key].startDegree < selectDegrees && selectDegrees < alcoholList[key].stopDegree) {
            return alcoholList[key]
        }
    })
    return arr.filter(function(item){ return item != null})
}



</script>
</body>
</html>